AuditEntry:
  description: A record of an auditable action performed by a principal.
  type: object
  properties:
    id:
      type: string
      pattern: '^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$'
      maxLength: 36
      example: "550e8400-e29b-41d4-a716-446655440000"
    principal_name:
      type: string
      maxLength: 255
      pattern: '^\S.*$'
      example: example-value
    action:
      type: string
      maxLength: 64
      pattern: '^\S+$'
      example: example-value
    statement_type:
      type: string
      maxLength: 64
      pattern: '^\S+$'
      nullable: true
      example: example-value
    original_sql:
      type: string
      maxLength: 65536
      pattern: '[\s\S]+'
      nullable: true
      example: example-value
    rewritten_sql:
      type: string
      maxLength: 65536
      pattern: '[\s\S]+'
      nullable: true
      example: example-value
    tables_accessed:
      type: array
      maxItems: 1000
      items:
        type: string
        maxLength: 255
        pattern: '^\S+$'
    status:
      type: string
      maxLength: 64
      pattern: '^\S+$'
      example: ACTIVE
    error_message:
      type: string
      maxLength: 4096
      pattern: '[\s\S]+'
      nullable: true
      example: example-value
    duration_ms:
      type: integer
      format: int64
      minimum: 0
      maximum: 9223372036854775807
      nullable: true
      example: 45
    created_at:
      type: string
      format: date-time
      maxLength: 64
      example: '2025-01-15T10:30:00Z'

PaginatedAuditLogs:
  description: A paginated list of audit log entries.
  type: object
  properties:
    data:
      type: array
      maxItems: 1000
      items:
        $ref: '#/AuditEntry'
      example: []
    next_page_token:
      type: string
      maxLength: 4096
      pattern: '^\S+$'
      example: eyJpZCI6MTB9

ManifestRequest:
  description: Request to retrieve the manifest for a specific table.
  type: object
  required: [table]
  properties:
    table:
      type: string
      maxLength: 255
      pattern: '^\S.*$'
      example: example-value
    schema:
      type: string
      maxLength: 255
      pattern: '^\S.*$'
      default: main
      example: example-value

ManifestColumn:
  description: A column definition within a table manifest.
  type: object
  properties:
    name:
      type: string
      maxLength: 255
      pattern: '^\S.*$'
      example: my-resource
    type:
      type: string
      maxLength: 64
      pattern: '^\S+$'
      example: example-value

ManifestResponse:
  description: The manifest of a table including its schema, files, and access controls.
  type: object
  properties:
    table:
      type: string
      maxLength: 255
      pattern: '^\S.*$'
      example: example-value
    schema:
      type: string
      maxLength: 255
      pattern: '^\S.*$'
      example: example-value
    columns:
      type: array
      maxItems: 10000
      items:
        $ref: '#/ManifestColumn'
      example:
      - name: id
        type: INTEGER
    files:
      type: array
      maxItems: 100000
      items:
        type: string
        maxLength: 2048
        pattern: '^\S+$'
      example: ["s3://bucket/data/part-001.parquet"]
    row_filters:
      type: array
      maxItems: 100
      items:
        type: string
        maxLength: 65536
        pattern: '[\s\S]+'
      example: ["region = 'north'"]
    column_masks:
      type: object
      additionalProperties:
        type: string
        maxLength: 255
        pattern: '[\s\S]+'
      example:
        email: "'***'"
    expires_at:
      type: string
      format: date-time
      maxLength: 64
      example: '2025-01-15T10:30:00Z'

QueryHistoryEntry:
  description: A historical record of a query executed by a principal.
  type: object
  properties:
    id:
      type: string
      pattern: '^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$'
      maxLength: 36
      example: "550e8400-e29b-41d4-a716-446655440000"
    principal_name:
      type: string
      maxLength: 255
      pattern: '^\S.*$'
      example: example-value
    original_sql:
      type: string
      maxLength: 65536
      pattern: '[\s\S]+'
      nullable: true
      example: example-value
    rewritten_sql:
      type: string
      maxLength: 65536
      pattern: '[\s\S]+'
      nullable: true
      example: example-value
    statement_type:
      type: string
      maxLength: 64
      pattern: '^\S+$'
      nullable: true
      example: example-value
    tables_accessed:
      type: array
      maxItems: 1000
      items:
        type: string
        maxLength: 255
        pattern: '^\S+$'
    status:
      type: string
      maxLength: 64
      pattern: '^\S+$'
      example: ACTIVE
    error_message:
      type: string
      maxLength: 4096
      pattern: '[\s\S]+'
      nullable: true
      example: example-value
    duration_ms:
      type: integer
      format: int64
      minimum: 0
      maximum: 9223372036854775807
      nullable: true
      example: 45
    rows_returned:
      type: integer
      format: int64
      minimum: 0
      maximum: 9223372036854775807
      nullable: true
      example: 100
    created_at:
      type: string
      format: date-time
      maxLength: 64
      example: '2025-01-15T10:30:00Z'

PaginatedQueryHistoryEntries:
  description: A paginated list of query history entries.
  type: object
  properties:
    data:
      type: array
      maxItems: 1000
      items:
        $ref: '#/QueryHistoryEntry'
      example: []
    next_page_token:
      type: string
      maxLength: 4096
      pattern: '^\S+$'
      example: eyJpZCI6MTB9
