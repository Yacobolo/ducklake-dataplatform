ComputeEndpoint:
  type: object
  properties:
    id:
      type: integer
      format: int64
    external_id:
      type: string
      format: uuid
    name:
      type: string
    url:
      type: string
    type:
      type: string
      enum: [LOCAL, REMOTE]
    status:
      type: string
      enum: [ACTIVE, INACTIVE, STARTING, STOPPING, ERROR]
    size:
      type: string
      enum: [SMALL, MEDIUM, LARGE]
    max_memory_gb:
      type: integer
      format: int64
    owner:
      type: string
    created_at:
      type: string
      format: date-time
    updated_at:
      type: string
      format: date-time

CreateComputeEndpointRequest:
  type: object
  required: [name, url, type]
  properties:
    name:
      type: string
    url:
      type: string
    type:
      type: string
      enum: [LOCAL, REMOTE]
    size:
      type: string
      enum: [SMALL, MEDIUM, LARGE]
    max_memory_gb:
      type: integer
      format: int64
    auth_token:
      type: string
      description: Pre-shared secret for remote agent authentication.

UpdateComputeEndpointRequest:
  type: object
  properties:
    url:
      type: string
    size:
      type: string
      enum: [SMALL, MEDIUM, LARGE]
    max_memory_gb:
      type: integer
      format: int64
    auth_token:
      type: string
    status:
      type: string
      enum: [ACTIVE, INACTIVE, STARTING, STOPPING, ERROR]

PaginatedComputeEndpoints:
  type: object
  properties:
    data:
      type: array
      items:
        $ref: '#/ComputeEndpoint'
    next_page_token:
      type: string

ComputeAssignment:
  type: object
  properties:
    id:
      type: integer
      format: int64
    principal_id:
      type: integer
      format: int64
    principal_type:
      type: string
      enum: [user, group]
    endpoint_id:
      type: integer
      format: int64
    endpoint_name:
      type: string
    is_default:
      type: boolean
    fallback_local:
      type: boolean
    created_at:
      type: string
      format: date-time

CreateComputeAssignmentRequest:
  type: object
  required: [principal_id, principal_type]
  properties:
    principal_id:
      type: integer
      format: int64
    principal_type:
      type: string
      enum: [user, group]
    is_default:
      type: boolean
      default: true
    fallback_local:
      type: boolean
      default: false

PaginatedComputeAssignments:
  type: object
  properties:
    data:
      type: array
      items:
        $ref: '#/ComputeAssignment'
    next_page_token:
      type: string

ComputeEndpointHealth:
  type: object
  properties:
    status:
      type: string
      description: Health status (e.g. "ok")
    uptime_seconds:
      type: integer
      description: Agent uptime in seconds
    duckdb_version:
      type: string
      description: DuckDB version running on the agent
    memory_used_mb:
      type: integer
      description: Current memory usage in MB
    max_memory_gb:
      type: integer
      description: Maximum memory limit in GB
    endpoint_name:
      type: string
      description: Name of the compute endpoint
