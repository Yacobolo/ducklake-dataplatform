global:
  default_output: table
  confirm_destructive: true
  implicit_params: [catalogName]

# Override tag-to-group mapping where convention doesn't match
group_overrides:
  Catalogs:
    name: catalog
    short: "Manage the data catalog"

# Only commands that deviate from conventions need entries.
# Convention defaults:
#   verb:            inferred from operationId prefix (list/create/get/update/delete)
#   command_path:    inferred from last non-parameter URL segment
#   positional_args: all path params except implicit_params
#   table_columns:   auto-derived from response schema scalar fields
#   confirm:         true for DELETE operations
#   group:           inferred from OpenAPI tag
command_overrides:
  # === Query (empty verb = special "execute" command) ===
  executeQuery:
    verb: ""
    command_path: []
    flag_aliases:
      sql:
        short: s

  # === Catalog ===
  getCatalog:
    command_path: []
    table_columns: []

  createSchema:
    positional_args: &name_positional [name]

  listSchemas:
    table_columns: [schema_id, name, catalog_name, owner, created_at]

  listTables:
    table_columns: [table_id, name, schema_name, table_type, owner, created_at]

  createTable:
    compound_flags:
      columns:
        fields: [name, type]
        separator: ":"

  listTableColumns:
    table_columns: [name, type, position, nullable, comment]

  profileTable:
    verb: profile
    command_path: [tables]

  listViews:
    table_columns: [id, name, schema_name, owner, created_at]

  listVolumes:
    table_columns: [id, name, volume_type, storage_location, owner, created_at]

  # === Security: non-CRUD verbs ===
  updatePrincipalAdmin:
    verb: set-admin
    command_path: [principals]

  createPrincipal:
    positional_args: *name_positional

  listPrincipals:
    table_columns: [id, name, type, is_admin, created_at]

  createGroup:
    positional_args: *name_positional

  listGroups:
    table_columns: [id, name, description, created_at]

  listGroupMembers:
    table_columns: [group_id, member_type, member_id]

  createGroupMember:
    verb: add

  deleteGroupMember:
    verb: remove
    confirm: false

  listGrants:
    table_columns: [id, principal_id, principal_type, securable_type, privilege, granted_at]

  deleteGrant:
    verb: revoke
    confirm: false

  listAPIKeys:
    table_columns: [id, principal_id, name, key_prefix, expires_at, created_at]

  cleanupExpiredAPIKeys:
    verb: cleanup
    command_path: [api-keys]

  listRowFilters:
    table_columns: [id, table_id, filter_sql, description, created_at]

  bindRowFilter:
    verb: bind
    command_path: [row-filters]

  unbindRowFilter:
    verb: unbind
    command_path: [row-filters]
    confirm: false

  listColumnMasks:
    table_columns: [id, table_id, column_name, mask_expression, created_at]

  bindColumnMask:
    verb: bind
    command_path: [column-masks]

  unbindColumnMask:
    verb: unbind
    command_path: [column-masks]
    confirm: false

  # === Ingestion: group override + custom verbs ===
  createUploadUrl:
    group: ingestion
    verb: upload-url
    command_path: []

  commitTableIngestion:
    group: ingestion
    verb: commit
    command_path: []
    flatten_fields: [options]

  loadTableExternalFiles:
    group: ingestion
    verb: load
    command_path: []
    flatten_fields: [options]

  # === Lineage: non-CRUD verbs + command_path override ===
  getTableLineage:
    command_path: [tables]

  getUpstreamLineage:
    verb: upstream
    command_path: [tables]
    table_columns: []

  getDownstreamLineage:
    verb: downstream
    command_path: [tables]
    table_columns: []

  purgeLineage:
    verb: purge
    command_path: []
    confirm: true

  deleteLineageEdge:
    command_path: [edges]

  # === Governance ===
  searchCatalog:
    verb: search
    command_path: []
    table_columns: []

  listTags:
    table_columns: [id, key, value, created_by, created_at]

  createTagAssignment:
    command_path: [tag-assignments]

  deleteTagAssignment:
    command_path: [tag-assignments]

  listClassifications:
    table_columns: [id, key, value, created_by, created_at]

  # === Observability ===
  getMetastoreSummary:
    verb: summary
    command_path: [metastore]

  listAuditLogs:
    table_columns: [id, principal_name, action, status, created_at]

  listQueryHistory:
    table_columns: [id, principal_name, status, duration_ms, created_at]

  # === Storage: command_path override (URL uses storage-credentials/external-locations) ===
  listStorageCredentials:
    command_path: [credentials]
    table_columns: [id, name, credential_type, owner, created_at]
  createStorageCredential:
    command_path: [credentials]
    positional_args: *name_positional
  getStorageCredential:
    command_path: [credentials]
  updateStorageCredential:
    command_path: [credentials]
  deleteStorageCredential:
    command_path: [credentials]

  listExternalLocations:
    command_path: [locations]
    table_columns: [id, name, url, credential_name, owner, created_at]
  createExternalLocation:
    command_path: [locations]
    positional_args: *name_positional
  getExternalLocation:
    command_path: [locations]
  updateExternalLocation:
    command_path: [locations]
  deleteExternalLocation:
    command_path: [locations]

  # === Manifest ===
  createManifest:
    command_path: []

  # === Compute: command_path override (URL uses compute-endpoints) ===
  listComputeEndpoints:
    command_path: [endpoints]
    table_columns: [id, name, url, type, status, size, owner]
  createComputeEndpoint:
    command_path: [endpoints]
    positional_args: *name_positional
  getComputeEndpoint:
    command_path: [endpoints]
  updateComputeEndpoint:
    command_path: [endpoints]
  deleteComputeEndpoint:
    command_path: [endpoints]
  getComputeEndpointHealth:
    verb: health
    command_path: [endpoints]
  listComputeAssignments:
    command_path: [assignments]
    table_columns: [id, principal_id, principal_type, endpoint_name, is_default, created_at]
  createComputeAssignment:
    command_path: [assignments]
  deleteComputeAssignment:
    command_path: [assignments]

  notebooks:
    short: "Manage notebooks, cells, sessions, and git repos"
    commands:
      list-notebooks:
        operation_id: listNotebooks
        command_path: []
        verb: list
        table_columns: [id, name, owner, created_at, updated_at]
      create-notebook:
        operation_id: createNotebook
        command_path: []
        verb: create
      get-notebook:
        operation_id: getNotebook
        command_path: []
        verb: get
        positional_args: [notebookId]
      update-notebook:
        operation_id: updateNotebook
        command_path: []
        verb: update
        positional_args: [notebookId]
      delete-notebook:
        operation_id: deleteNotebook
        command_path: []
        verb: delete
        positional_args: [notebookId]
        confirm: true
      create-cell:
        operation_id: createCell
        command_path: [cells]
        verb: create
        positional_args: [notebookId]
      update-cell:
        operation_id: updateCell
        command_path: [cells]
        verb: update
        positional_args: [notebookId, cellId]
      delete-cell:
        operation_id: deleteCell
        command_path: [cells]
        verb: delete
        positional_args: [notebookId, cellId]
        confirm: true
      reorder-cells:
        operation_id: reorderCells
        command_path: [cells]
        verb: reorder
        positional_args: [notebookId]
      create-session:
        operation_id: createNotebookSession
        command_path: [sessions]
        verb: create
        positional_args: [notebookId]
      close-session:
        operation_id: closeNotebookSession
        command_path: [sessions]
        verb: close
        positional_args: [notebookId, sessionId]
      execute-cell:
        operation_id: executeCell
        command_path: [sessions]
        verb: execute
        positional_args: [notebookId, sessionId, cellId]
      run-all:
        operation_id: runAllCells
        command_path: [sessions]
        verb: run-all
        positional_args: [notebookId, sessionId]
      run-all-async:
        operation_id: runAllCellsAsync
        command_path: [sessions]
        verb: run-all-async
        positional_args: [notebookId, sessionId]
      list-jobs:
        operation_id: listNotebookJobs
        command_path: [jobs]
        verb: list
        positional_args: [notebookId]
        table_columns: [id, notebook_id, session_id, state, created_at, updated_at]
      get-job:
        operation_id: getNotebookJob
        command_path: [jobs]
        verb: get
        positional_args: [notebookId, jobId]
      list-git-repos:
        operation_id: listGitRepos
        command_path: [git-repos]
        verb: list
        table_columns: [id, url, branch, path, owner, last_sync_at, created_at]
      create-git-repo:
        operation_id: createGitRepo
        command_path: [git-repos]
        verb: create
      get-git-repo:
        operation_id: getGitRepo
        command_path: [git-repos]
        verb: get
        positional_args: [gitRepoId]
      delete-git-repo:
        operation_id: deleteGitRepo
        command_path: [git-repos]
        verb: delete
        positional_args: [gitRepoId]
        confirm: true
      sync-git-repo:
        operation_id: syncGitRepo
        command_path: [git-repos]
        verb: sync
        positional_args: [gitRepoId]

  pipelines:
    short: "Manage pipelines, jobs, and runs"
    commands:
      list-pipelines:
        operation_id: listPipelines
        command_path: []
        verb: list
        table_columns: [id, name, schedule_cron, is_paused, created_by, created_at]
      create-pipeline:
        operation_id: createPipeline
        command_path: []
        verb: create
      get-pipeline:
        operation_id: getPipeline
        command_path: []
        verb: get
        positional_args: [pipelineName]
      update-pipeline:
        operation_id: updatePipeline
        command_path: []
        verb: update
        positional_args: [pipelineName]
      delete-pipeline:
        operation_id: deletePipeline
        command_path: []
        verb: delete
        positional_args: [pipelineName]
        confirm: true
      list-jobs:
        operation_id: listPipelineJobs
        command_path: [jobs]
        verb: list
        positional_args: [pipelineName]
        table_columns: [id, name, notebook_id, depends_on, timeout_seconds, retry_count, job_order, created_at]
      create-job:
        operation_id: createPipelineJob
        command_path: [jobs]
        verb: create
        positional_args: [pipelineName]
      delete-job:
        operation_id: deletePipelineJob
        command_path: [jobs]
        verb: delete
        positional_args: [pipelineName, jobId]
        confirm: true
      trigger-run:
        operation_id: triggerPipelineRun
        command_path: [runs]
        verb: trigger
        positional_args: [pipelineName]
      list-runs:
        operation_id: listPipelineRuns
        command_path: [runs]
        verb: list
        positional_args: [pipelineName]
        table_columns: [id, status, trigger_type, triggered_by, started_at, finished_at, created_at]
      get-run:
        operation_id: getPipelineRun
        command_path: [runs]
        verb: get
        positional_args: [runId]
      cancel-run:
        operation_id: cancelPipelineRun
        command_path: [runs]
        verb: cancel
        positional_args: [runId]
      list-job-runs:
        operation_id: listPipelineJobRuns
        command_path: [job-runs]
        verb: list
        positional_args: [runId]
        table_columns: [id, job_id, job_name, status, started_at, finished_at, retry_attempt, created_at]

skip_operations:
  - createRowFilterTopLevel
