global:
  default_output: table
  confirm_destructive: true
  implicit_params: [catalogName]

# Override tag-to-group mapping where convention doesn't match
group_overrides:
  Catalogs:
    name: catalog
    short: "Manage the data catalog"
  Notebooks:
    short: "Notebooks, cells, sessions, and Git repositories"
  Pipelines:
    short: "Data pipelines, jobs, and runs"

# Only commands that deviate from conventions need entries.
# Convention defaults:
#   verb:            inferred from operationId prefix (list/create/get/update/delete)
#   command_path:    inferred from last non-parameter URL segment
#   positional_args: all path params except implicit_params
#   table_columns:   auto-derived from response schema scalar fields
#   confirm:         true for DELETE operations
#   group:           inferred from OpenAPI tag
command_overrides:
  # === Query (empty verb = special "execute" command) ===
  executeQuery:
    verb: ""
    command_path: []
    flag_aliases:
      sql:
        short: s

  # === Catalog: registration management ===
  registerCatalog:
    verb: register
    command_path: []
    positional_args: [name]

  listCatalogs:
    verb: list-registrations
    command_path: []
    table_columns: []   # non-standard pagination (uses "catalogs" not "data")

  getCatalogRegistration:
    verb: get-registration
    command_path: []
    positional_args: [catalogName]

  updateCatalogRegistration:
    verb: update-registration
    command_path: []
    positional_args: [catalogName]

  deleteCatalogRegistration:
    verb: delete-registration
    command_path: []
    positional_args: [catalogName]

  setDefaultCatalog:
    verb: set-default
    command_path: []
    positional_args: [catalogName]

  # === Catalog: data operations ===
  getCatalog:
    command_path: []
    table_columns: []

  createSchema:
    positional_args: &name_positional [name]

  listSchemas:
    table_columns: [schema_id, name, catalog_name, owner, created_at]

  listTables:
    table_columns: [table_id, name, schema_name, table_type, owner, created_at]

  createTable:
    compound_flags:
      columns:
        fields: [name, type]
        separator: ":"

  listTableColumns:
    table_columns: [name, type, position, nullable, comment]

  profileTable:
    verb: profile
    command_path: [tables]

  listViews:
    table_columns: [id, name, schema_name, owner, created_at]

  listVolumes:
    table_columns: [id, name, volume_type, storage_location, owner, created_at]

  # === Security: non-CRUD verbs ===
  updatePrincipalAdmin:
    verb: set-admin
    command_path: [principals]

  createPrincipal:
    positional_args: *name_positional

  listPrincipals:
    table_columns: [id, name, type, is_admin, created_at]

  createGroup:
    positional_args: *name_positional

  listGroups:
    table_columns: [id, name, description, created_at]

  listGroupMembers:
    table_columns: [group_id, member_type, member_id]

  createGroupMember:
    verb: add

  deleteGroupMember:
    verb: remove
    confirm: false

  listGrants:
    table_columns: [id, principal_id, principal_type, securable_type, privilege, granted_at]

  deleteGrant:
    verb: revoke
    confirm: false

  listAPIKeys:
    table_columns: [id, principal_id, name, key_prefix, expires_at, created_at]

  cleanupExpiredAPIKeys:
    verb: cleanup
    command_path: [api-keys]

  listRowFilters:
    table_columns: [id, table_id, filter_sql, description, created_at]

  bindRowFilter:
    verb: bind
    command_path: [row-filters]

  unbindRowFilter:
    verb: unbind
    command_path: [row-filters]
    confirm: false

  listColumnMasks:
    table_columns: [id, table_id, column_name, mask_expression, created_at]

  bindColumnMask:
    verb: bind
    command_path: [column-masks]

  unbindColumnMask:
    verb: unbind
    command_path: [column-masks]
    confirm: false

  # === Ingestion: group override + custom verbs ===
  createUploadUrl:
    group: ingestion
    verb: upload-url
    command_path: []

  commitTableIngestion:
    group: ingestion
    verb: commit
    command_path: []
    flatten_fields: [options]

  loadTableExternalFiles:
    group: ingestion
    verb: load
    command_path: []
    flatten_fields: [options]

  # === Lineage: non-CRUD verbs + command_path override ===
  getTableLineage:
    command_path: [tables]

  getUpstreamLineage:
    verb: upstream
    command_path: [tables]
    table_columns: []

  getDownstreamLineage:
    verb: downstream
    command_path: [tables]
    table_columns: []

  purgeLineage:
    verb: purge
    command_path: []
    confirm: true

  deleteLineageEdge:
    command_path: [edges]

  # === Governance ===
  searchCatalog:
    verb: search
    command_path: []
    table_columns: []

  listTags:
    table_columns: [id, key, value, created_by, created_at]

  createTagAssignment:
    command_path: [tag-assignments]

  deleteTagAssignment:
    command_path: [tag-assignments]

  listClassifications:
    table_columns: [id, key, value, created_by, created_at]

  # === Observability ===
  getMetastoreSummary:
    verb: summary
    command_path: [metastore]

  listAuditLogs:
    table_columns: [id, principal_name, action, status, created_at]

  listQueryHistory:
    table_columns: [id, principal_name, status, duration_ms, created_at]

  # === Storage: command_path override (URL uses storage-credentials/external-locations) ===
  listStorageCredentials:
    command_path: [credentials]
    table_columns: [id, name, credential_type, owner, created_at]
  createStorageCredential:
    command_path: [credentials]
    positional_args: *name_positional
  getStorageCredential:
    command_path: [credentials]
  updateStorageCredential:
    command_path: [credentials]
  deleteStorageCredential:
    command_path: [credentials]

  listExternalLocations:
    command_path: [locations]
    table_columns: [id, name, url, credential_name, owner, created_at]
  createExternalLocation:
    command_path: [locations]
    positional_args: *name_positional
  getExternalLocation:
    command_path: [locations]
  updateExternalLocation:
    command_path: [locations]
  deleteExternalLocation:
    command_path: [locations]

  # === Manifest ===
  createManifest:
    command_path: []

  # === Compute: command_path override (URL uses compute-endpoints) ===
  listComputeEndpoints:
    command_path: [endpoints]
    table_columns: [id, name, url, type, status, size, owner]
  createComputeEndpoint:
    command_path: [endpoints]
    positional_args: *name_positional
  getComputeEndpoint:
    command_path: [endpoints]
  updateComputeEndpoint:
    command_path: [endpoints]
  deleteComputeEndpoint:
    command_path: [endpoints]
  getComputeEndpointHealth:
    verb: health
    command_path: [endpoints]
  listComputeAssignments:
    command_path: [assignments]
    table_columns: [id, principal_id, principal_type, endpoint_name, is_default, created_at]
  createComputeAssignment:
    command_path: [assignments]
  deleteComputeAssignment:
    command_path: [assignments]

  # === Notebooks ===
  createNotebook:
    positional_args: *name_positional

  listNotebooks:
    table_columns: [id, name, owner, created_at, updated_at]

  deleteCell:
    confirm: false

  reorderCells:
    verb: reorder
    command_path: [cells]

  closeNotebookSession:
    verb: close
    command_path: [sessions]
    confirm: false

  executeCell:
    verb: execute
    command_path: [cells]

  runAllCells:
    verb: run-all
    command_path: [sessions]

  runAllCellsAsync:
    verb: run-all-async
    command_path: [sessions]

  listNotebookJobs:
    table_columns: [id, notebook_id, state, created_at, updated_at]

  listGitRepos:
    table_columns: [id, url, branch, owner, last_sync_at, created_at]

  syncGitRepo:
    verb: sync
    command_path: [git-repos]

  # === Pipelines ===
  createPipeline:
    positional_args: *name_positional

  listPipelines:
    table_columns: [id, name, schedule_cron, is_paused, created_by, created_at]

  listPipelineJobs:
    table_columns: []  # bare array response, not standard pagination

  triggerPipelineRun:
    verb: trigger
    command_path: [runs]

  listPipelineRuns:
    table_columns: [id, status, trigger_type, triggered_by, started_at, finished_at]

  cancelPipelineRun:
    verb: cancel
    command_path: [runs]

  listPipelineJobRuns:
    verb: list-job-runs
    command_path: [runs]
    table_columns: []  # bare array response, not standard pagination

skip_operations:
  - createRowFilterTopLevel
