# ==============================================================================
# Server Configuration
# ==============================================================================

# HTTP listen address (default: ":8080")
LISTEN_ADDR=:8080

# Flight SQL listener (default: ":32010", disabled unless FEATURE_FLIGHT_SQL=true)
FLIGHT_SQL_LISTEN_ADDR=:32010

# PostgreSQL wire listener (default: ":5433", disabled unless FEATURE_PG_WIRE=true)
PG_WIRE_LISTEN_ADDR=:5433

# Log level: debug, info, warn, error (default: "info")
LOG_LEVEL=info

# Path to SQLite metadata/permissions database (default: "ducklake_meta.sqlite")
META_DB_PATH=ducklake_meta.sqlite

# Environment: "development" (default) or "production".
# In production mode, OIDC auth and ENCRYPTION_KEY are required.
# ENV=production

# Optional TLS certificate and private key for the API server.
# In production, TLS_CERT_FILE and TLS_KEY_FILE are required unless
# ALLOW_INSECURE_HTTP=true is explicitly set (for trusted TLS termination).
# TLS_CERT_FILE=/path/to/server.crt
# TLS_KEY_FILE=/path/to/server.key
# ALLOW_INSECURE_HTTP=false

# Distributed protocol feature flags
# FEATURE_INTERNAL_GRPC=true
# FEATURE_FLIGHT_SQL=true
# FEATURE_PG_WIRE=true

# ==============================================================================
# Rate Limiting
# ==============================================================================

# Sustained requests per second (default: 100)
# RATE_LIMIT_RPS=100

# Maximum burst capacity (default: 200)
# RATE_LIMIT_BURST=200

# ==============================================================================
# Authentication / Security
# ==============================================================================

# OIDC issuer URL (for discovery-based JWT validation).
# Set AUTH_ISSUER_URL + AUTH_AUDIENCE, or set AUTH_JWKS_URL directly.
AUTH_ISSUER_URL=

# Optional explicit JWKS URL (use when discovery is unavailable).
AUTH_JWKS_URL=

# Required when AUTH_ISSUER_URL is set.
AUTH_AUDIENCE=

# 64-character hex string (32-byte AES-256-GCM key) for encrypting stored
# credentials at rest in SQLite.
# REQUIRED in production — insecure all-zeros default used if unset.
ENCRYPTION_KEY=0000000000000000000000000000000000000000000000000000000000000000

# ==============================================================================
# S3-Compatible Storage (optional — enables DuckLake catalog + ingestion)
# ==============================================================================
# All four (KEY_ID, SECRET, ENDPOINT, REGION) must be set to enable S3 mode.
# Tests that require S3 will gracefully skip if these are absent.

# S3 access key ID
KEY_ID=

# S3 secret access key
SECRET=

# S3-compatible endpoint hostname (e.g. fsn1.your-objectstorage.com)
ENDPOINT=

# S3 region identifier (e.g. fsn1)
REGION=

# S3 bucket name (default: "duck-demo")
BUCKET=duck-demo

# ==============================================================================
# Compute Agent Security (optional)
# ==============================================================================

# Shared token used between control plane and compute agent.
# AGENT_TOKEN=

# Max execution time per remote query (default: 2m)
# AGENT_QUERY_TIMEOUT=2m

# Max rows returned by compute agent per request (default: 10000)
# AGENT_MAX_RESULT_ROWS=10000

# Max concurrent query executions accepted by compute agent (default: 8)
# AGENT_MAX_CONCURRENT_QUERIES=8

# Require timestamped HMAC signatures on agent requests (default: true)
# AGENT_REQUIRE_SIGNED_REQUESTS=true

# Allowed clock skew for signed requests (default: 2m)
# AGENT_SIGNATURE_MAX_SKEW=2m
