apiVersion: duck/v1
kind: Model
metadata:
  name: silver_movies
spec:
  materialization: TABLE
  description: Conformed movie dimension with release year extraction
  tags: [silver, movielens]
  sql: |
    SELECT
      movie_id,
      title,
      genres,
      regexp_extract(title, '\\((\\d{4})\\)$', 1) AS release_year
    FROM lake.main.bronze_movies
